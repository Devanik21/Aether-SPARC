name: Dev Log Automation (FAST TEST)

on:
  workflow_dispatch:

jobs:
  dev-log-test:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Configure git identity
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"

      - name: Decide random commit count (5â€“10)
        run: echo "COUNT=$((RANDOM % 6 + 5))" >> $GITHUB_ENV

      - name: Generate commits instantly
        run: |
          mkdir -p docs
          touch docs/dev_log.md

          NOTES=(
            "Test: validating per-commit execution semantics."
            "Test: confirming auto-commit behavior."
            "Test: verifying commit loop integrity."
            "Test: ensuring documentation-only diff."
            "Test: checking workflow permissions."
            "Test: validating commit frequency control."
            "Test: confirming no code paths are touched."
            "Test: verifying GitHub Actions identity."
            "Test: confirming push stability."
            "Test: end-to-end automation check."
          )

          for i in $(seq 1 $COUNT); do
            IDX=$((RANDOM % ${#NOTES[@]}))
            echo "- ${NOTES[$IDX]}" >> docs/dev_log.md
            git add docs/dev_log.md
            git commit -m "test: dev log commit $i"
          done

      - name: Push commits
        run: git push
